var ZeroTierNetwork=React.createClass({displayName:"ZeroTierNetwork",getInitialState:function(){return{}},leaveNetwork:function(e){Ajax.call({url:window.ui_addr+"network/"+this.props.nwid+"?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"DELETE",success:function(e){this.props.onNetworkDeleted&&this.props.onNetworkDeleted(this.props.nwid)}.bind(this),error:function(e){}.bind(this)}),e.preventDefault()},render:function(){return React.createElement("div",{className:"zeroTierNetwork"},React.createElement("div",{className:"networkInfo"},React.createElement("span",{className:"networkId"},this.props.nwid)," ",React.createElement("span",{className:"networkName"},this.props.name)),React.createElement("div",{className:"networkProps"},React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"Status"),React.createElement("div",{className:"value"},this.props.status)),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"Type"),React.createElement("div",{className:"value"},this.props.type)),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"MAC"),React.createElement("div",{className:"value zeroTierAddress"},this.props.mac)),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"MTU"),React.createElement("div",{className:"value"},this.props.mtu)),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"Broadcast"),React.createElement("div",{className:"value"},this.props.broadcastEnabled?"ENABLED":"DISABLED")),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"Bridging"),React.createElement("div",{className:"value"},this.props.bridge?"ACTIVE":"DISABLED")),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"Device"),React.createElement("div",{className:"value"},this.props.portDeviceName?this.props.portDeviceName:"(none)")),React.createElement("div",{className:"row"},React.createElement("div",{className:"name"},"Managed IPs"),React.createElement("div",{className:"value ipList"},this.props.assignedAddresses.map(function(e){return React.createElement("div",{key:e,className:"ipAddress"},e)})))),React.createElement("button",{type:"button",className:"leaveNetworkButton",onClick:this.leaveNetwork},"Leave Network"))}}); var ZeroTierNode=React.createClass({displayName:"ZeroTierNode",getInitialState:function(){return"https:"==location.protocol?window.ui_port=80:window.ui_port=80,window.auth_addr=location.protocol+"//"+document.location.host+"/",window.ui_addr=location.protocol+"//"+document.location.hostname+":"+ui_port+"/",this.authenticated=true,{address:"----------",online:!1,version:"_._._",_networks:[],_peers:[]}},ago:function(e){if(e>0){var t=Math.round((Date.now()-e)/1e3);return t>0?t:0}return 0},updatePeers:function(){Ajax.call({url:window.ui_addr+"peer?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"GET",success:function(e){if(e){var t=JSON.parse(e);Array.isArray(t)&&this.setState({_peers:t})}}.bind(this),error:function(){}.bind(this)})},updateNetworks:function(){Ajax.call({url:window.ui_addr+"network?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"GET",success:function(e){if(e){var t=JSON.parse(e);Array.isArray(t)&&this.setState({_networks:t})}}.bind(this),error:function(){}.bind(this)})},requestAuth:function(){this.dispatchRequest("auth",{})},requestVersion:function(){this.dispatchRequest("version",{})},dispatchRequest:function(e,t){Ajax.call({url:window.ui_addr+e+"?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"GET",success:function(e){var t=JSON.parse(e.responseText);alert("data="+t)}.bind(this),error:function(e){this.setState("UNAUTH")}.bind(this)})},getCookieVal:function(e){var t=document.cookie.indexOf(";",e);return t==-1&&(t=document.cookie.length),unescape(document.cookie.substring(e,t))},getCookie:function(e){for(var t=e+"=",n=t.length,i=document.cookie.length,o=0,r=0;o<i;){if(r=o+n,document.cookie.substring(o,r)==t)return this.getCookieVal(r);if(o=document.cookie.indexOf(" ",o)+1,0===o)break}return null},syno_init:function(){"SynoToken"!=this.CSRF_TOKEN_KEY&&(window.CSRF_TOKEN_KEY="SynoToken",window.CSRF_TOKEN_VAL=null,window.COOKIE_KEY="Cookie",window.COOKIE_VAL="id="+this.getCookie("id"),Ajax.call({url:window.auth_addr+"webman/login.cgi",type:"GET",success:function(e){if(this.alertedToFailure=!1,e){var t=JSON.parse(e);window.CSRF_TOKEN_VAL=t[window.CSRF_TOKEN_KEY],this.authenticated=!0}this.requestAuth()}.bind(this),error:function(e){this.setState("UNAUTH")}.bind(this)}))},updateAll:function(){this.authenticated&&Ajax.call({url:window.ui_addr+"status?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"GET",success:function(e){if(this.alertedToFailure=!1,e){var t=JSON.parse(e);this.setState(t),document.title="ZeroTier One ["+t.address+"]"}this.updateNetworks(),this.updatePeers()}.bind(this),error:function(e){this.setState("UNAUTH")}.bind(this)})},joinNetwork:function(e){e.preventDefault(),this.networkToJoin&&16===this.networkToJoin.length?Ajax.call({url:window.ui_addr+"network/"+this.networkToJoin+"?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"POST",success:function(e){this.networkToJoin="",this.networkInputElement&&(this.networkInputElement.value=""),this.updateNetworks()}.bind(this),error:function(){}.bind(this)}):alert("To join a network, create a network at https://my.zerotier.com and enter its 16-digit network ID here.")},resetService:function(e){e.preventDefault(),Ajax.call({url:window.ui_addr+"reset?"+window.COOKIE_KEY+"="+window.COOKIE_VAL+window.CSRF_TOKEN_KEY+"="+window.CSRF_TOKEN_VAL,type:"POST",success:function(e){}.bind(this),error:function(){}.bind(this)})},handleNetworkIdEntry:function(e){this.networkInputElement=e.target;var t=this.networkInputElement.value;if(t){t=t.toLowerCase();for(var n="",i=0;i<t.length&&i<16;++i)"0123456789abcdef".indexOf(t.charAt(i))>=0&&(n+=t.charAt(i));this.networkToJoin=n,this.networkInputElement.value=n}else this.networkToJoin="",this.networkInputElement.value=""},handleNetworkDelete:function(e){for(var t=[],n=0;n<this.state._networks.length;++n)this.state._networks[n].nwid!==e&&t.push(this.state._networks[n]);this.setState({_networks:t})},componentDidMount:function(){this.updateAll(),this.updateIntervalId=setInterval(this.updateAll,2500)},componentWillUnmount:function(){clearInterval(this.updateIntervalId)},render:function(){return React.createElement("div",{className:"zeroTierNode"},React.createElement("div",{className:"middle"},React.createElement("div",{className:"middleCell"},React.createElement("div",{className:"middleScroll"},React.createElement("div",{className:"networks",key:"_networks"},this.state._networks.map(function(e){return e.onNetworkDeleted=this.handleNetworkDelete,React.createElement("div",{className:"network",key:e.nwid},React.createElement(ZeroTierNetwork,e))}.bind(this)))))),React.createElement("div",{className:"bottom"},React.createElement("div",{className:"left"},React.createElement("span",{className:"statusLine"},React.createElement("span",{className:"zeroTierAddress"},this.state.address),"  ",this.state.online?this.state.tcpFallbackActive?"TUNNELED":"ONLINE":"OFFLINE","  ",this.state.version)),React.createElement("div",{className:"right"},React.createElement("form",{onSubmit:this.joinNetwork},React.createElement("input",{type:"text",maxlength:"16",placeholder:"[ Network ID ]",onChange:this.handleNetworkIdEntry,size:"16"}),React.createElement("button",{type:"button",onClick:this.joinNetwork},"Join")))))}});
